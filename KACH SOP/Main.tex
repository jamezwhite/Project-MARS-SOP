%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Preamble %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[]{report}

\usepackage{titling}               % Adds control for typestting of the \maketitle command
\usepackage{newtxtext}
\usepackage{xspace}
\usepackage{fancyhdr}              % Gives Control over headers and footers
\usepackage{acro}                  % Adds Acronym Glossing and Appendix
\usepackage[section=section]{glossaries}            % Adds Term Glossing and Appendix
\usepackage{blindtext}             % Creates Lorem Ipsum when asked for
\usepackage{titlesec}              % Allows for Alternative Section Titles
\usepackage[normalem]{ulem} % keeps \emph italic instead of underlined
\usepackage{graphicx}              % Allows for image use
\usepackage[titletoc]{appendix}    % Gives extra control of appendices
\usepackage[
  letterpaper,
  margin=1in,          % set all margins; tweak to taste (e.g., 0.8in)
  includeheadfoot,     % count header & footer space inside the margins
  headheight=14pt,     % matches your fancyhdr header content height
  headsep=10pt,        % space between header and text
  footskip=24pt        % space from bottom of text to baseline of footer
]{geometry}                        %Flexible and Complete Interface to Document Dimensions
\usepackage[hidelinks]{hyperref}
\usepackage{cleveref}              %Allows for intelligent crossreferencing
\usepackage{pdfcomment}            % Allows for Tooltips in PDF
\usepackage{enumitem}              % for tidy list spacing

\renewcommand{\familydefault}{\sfdefault} % Use sans-serif font
\DeclareRobustCommand{\projectmars}{Project \ac{mars}\xspace} % Makes a \projectmars command that inputs the Project name when called.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Header/Footer Formatting %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagestyle{fancy} % use fancyhdr package to customize headers/footers
\fancyhf{} % clear all header and footer fields

% Expose the date you set for the title page so we can reuse it in the footer
\makeatletter
\newcommand{\frontpagedate}{\@date} % this will mirror whatever you put in \date{...}
\makeatother

% Put ONLY the chapter title (not "Chapter 1") in the running header mark
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}

% --- Header: top-left shows chapter title on non-opening pages
\fancyhead[L]{\nouppercase{\leftmark}}

% --- Footer: left = fixed text + front-page date, right = page number
\fancyfoot[L]{Project MARS SOP, \thedate}
\fancyfoot[R]{\thepage}

% Optional rules (lines). Header rule on; footer rule off.
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

% Make chapter opening pages use a blank header but keep the same footer
% (report class sets chapter openings to \thispagestyle{plain} by default)
\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyfoot[L]{Project MARS SOP, \thedate}%
  \fancyfoot[R]{\thepage}%
  \renewcommand{\headrulewidth}{0pt}%
}

% Prevent the classic "Package Fancyhdr Warning: \headheight is too small"
\setlength{\headheight}{14pt} % bump if you add taller content

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Acronym Setup and Tooltips %%%%%%%%%%%%%%%%%%%%%%%%%%%
% Load all acronyms from source file
\input{glossaries/ABCA}

% Redefine commands after everything is loaded to turn on tooltips
\AtBeginDocument{%
    \let\oldac\ac
    \renewcommand{\ac}[1]{%
        \pdftooltip{\oldac{#1}}{\acl{#1}}%
    }%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Term Setup and Tooltips %%%%%%%%%%%%%%%%%%%%%%%%%%%
% Load all acronyms from source file
\makenoidxglossaries
\input{glossaries/Terms}

\AtBeginDocument{%
  % Show tooltip with the entry's description when hovering the term
  \NewDocumentCommand{\term}{m}{\pdftooltip{\gls{#1}}{\glsentrydesc{#1}}}
  \NewDocumentCommand{\Term}{m}{\pdftooltip{\Gls{#1}}{\glsentrydesc{#1}}}
  \NewDocumentCommand{\terms}{m}{\pdftooltip{\glspl{#1}}{\glsentrydesc{#1}}}
  \NewDocumentCommand{\Terms}{m}{\pdftooltip{\Glspl{#1}}{\glsentrydesc{#1}}}
}

\newglossarystyle{termabove}{%
  \setglossarystyle{list}% start from the basic list style
  \renewenvironment{theglossary}%
    {\begin{description}[leftmargin=0pt,labelsep=0pt,itemsep=.6\baselineskip]}%
    {\end{description}}%
  \renewcommand*{\glossentry}[2]{%
    \item[]%
      \glstarget{##1}{\textbf{\glsentryname{##1}}}\par
      \glossentrydesc{##1}\glspostdescription\space ##2%
  }%
  \renewcommand*{\glsgroupskip}{}% suppress A/B/C group headings
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% % Reference  Formatting %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\crefformat{chapter}{Chapter~#2#1 (\descriptionlabel{#1})#3}
\Crefformat{chapter}{Chapter~#2#1 (\descriptionlabel{#1})#3}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% % Section  Formatting %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
    % Numbering policy: number through \paragraph; leave \subparagraph unnumbered
    \setcounter{secnumdepth}{5}
    % Optional: how deep to list in the ToC (tweak as you like)
    \setcounter{tocdepth}{2}

% --------Chapter--------
    \renewcommand{\thechapter}{\arabic{chapter}}
    \titleformat{\chapter}[display]
      {\normalfont\Huge\bfseries}%
      {Chapter \thechapter}{0.5ex}{\LARGE}
    \titlespacing*{\chapter}{0pt}{*3}{*2}

% --------Section--------

    \renewcommand{\thesection}{\thechapter-\arabic{section}}
    \titleformat{\section}
      {\normalfont\Large\bfseries}%
      {\thesection}{0.6em}{}
    \titlespacing*{\section}{0pt}{*2}{0.5\baselineskip}

% --------Subsection--------

    \renewcommand{\thesubsection}{\thesection.\arabic{subsection}}
    \titleformat{\subsection}
      {\normalfont\large\bfseries}%
      {\thesubsection}{0.6em}{}
    \titlespacing*{\subsection}{0.10in}{*1.5}{0.4\baselineskip}

% --------Subsubsection--------

    \makeatletter
    \@addtoreset{subsubsection}{subsection} % restart a., b., c. each subsection
    \makeatother
    \renewcommand{\thesubsubsection}{\alph{subsubsection}}
    \titleformat{\subsubsection}[runin]
      {\normalfont\normalsize\bfseries}%
      {\textit{\thesubsubsection.}}{0.75em}{}
      [\normalfont]
    \titlespacing*{\subsubsection}{0.25in}{0.5\baselineskip}{0.75em}

% --------Paragraph--------

    \makeatletter
    \@addtoreset{paragraph}{subsubsection} % restart (1), (2) under each letter
    \makeatother
    \renewcommand{\theparagraph}{(\arabic{paragraph})}
    \titleformat{\paragraph}[runin]
      {\normalfont\normalsize}%
      {\theparagraph}{0.75em}{\underline}
      [\normalfont]
    \titlespacing*{\paragraph}{0.5in}{0.25\baselineskip}{0.75em}

% --------Subparagraph--------

    \makeatletter
    \@addtoreset{subparagraph}{paragraph} % restart i, ii, iii under each number
    \makeatother
    \renewcommand{\thesubparagraph}{(\roman{subparagraph})}
    \titleformat{\subparagraph}[runin]
      {\normalfont\normalsize}%
      {\thesubparagraph}{.75em}{\bfseries}
      [\normalfont]
    \titlespacing*{\subparagraph}{.5in}{0.25\baselineskip}{0.75em}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Document Information %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Project MARS - Standard Operating Procedure}
\author{SFC Jamez White, Project NCOIC}
\date{01 Dec 2025}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Document Content %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\include{frontmatter/frontpage}

\tableofcontents
\listoffigures
\listoftables

\include{chapters/General}
\include{chapters/Roles and Responsibilities}
\include{chapters/Airframe and Supporting Systems}
\include{chapters/Pilot Certification}
\include{chapters/Flight Operations}
\include{chapters/Maintenance}
\include{chapters/Safety}

\begin{appendices}
\include{appendices/References}
\include{appendices/Checklists}
\include{appendices/Forms}
\include{appendices/uas characteristics}
\end{appendices}
\include{glossaries/Glossary}
\end{document}

